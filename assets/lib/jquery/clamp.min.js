(function(e,t){"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?module.exports={clamp:t()}:e.$clamp=t()})(this,function(){function e(e,t){function n(e,t){return s.getComputedStyle||(s.getComputedStyle=function(e,t){return this.el=e,this.getPropertyValue=function(t){var n=/(\-([a-z]){1})/g;return"float"==t&&(t="styleFloat"),n.test(t)&&(t=t.replace(n,function(){return arguments[2].toUpperCase()})),e.currentStyle&&e.currentStyle[t]?e.currentStyle[t]:null},this}),s.getComputedStyle(e,null).getPropertyValue(t)}function i(t){var n=t||e.clientHeight,i=a(e);return Math.max(Math.floor(n/i),0)}function l(t){var n=a(e);return n*t}function a(e){var t=n(e,"line-height");return"normal"==t&&(t=1.187*parseInt(n(e,"font-size"))),Math.ceil(parseFloat(t))}function r(t){if(t.lastChild)return t.lastChild.childNodes&&t.lastChild.childNodes.length>0?r(Array.prototype.slice.call(t.childNodes).pop()):t.lastChild&&t.lastChild.nodeValue&&""!==t.lastChild.nodeValue&&t.lastChild.nodeValue!=p.truncationChar?t.lastChild:(t.lastChild.parentNode.removeChild(t.lastChild),r(e))}function o(t,n){function i(){H=p.splitOnChars.slice(0),M=H[0],v=null,g=null}if(t&&n){var l=t.nodeValue.replace(p.truncationChar,"");if(v||(M=H.length>0?H.shift():"",v=l.split(M)),v.length>1?(g=v.pop(),u(t,v.join(M))):v=null,c&&(t.nodeValue=t.nodeValue.replace(p.truncationChar,""),e.innerHTML=t.nodeValue+" "+c.innerHTML+p.truncationChar),v){if(e.clientHeight<=n){if(!(H.length>=0&&""!==M))return e.innerHTML;u(t,v.join(M)+M+g),v=null}}else""===M&&(u(t,""),t=r(e),i());if(!p.animate)return o(t,n);setTimeout(function(){o(t,n)},!0===p.animate?10:p.animate)}}function u(e,t){e.nodeValue=t+p.truncationChar}t=t||{};var c,s=window,p={clamp:t.clamp||2,useNativeClamp:void 0===t.useNativeClamp||t.useNativeClamp,splitOnChars:t.splitOnChars||[".","-","–","—"," "],animate:t.animate||!1,truncationChar:t.truncationChar||"…",truncationHTML:t.truncationHTML},d=e.style,h=e.innerHTML,f=void 0!==e.style.webkitLineClamp,C=p.clamp,m=C.indexOf&&(C.indexOf("px")>-1||C.indexOf("em")>-1);p.truncationHTML&&(c=document.createElement("span"),c.innerHTML=p.truncationHTML);var v,g,y,H=p.splitOnChars.slice(0),M=H[0];if("auto"==C?C=i():m&&(C=i(parseInt(C))),f&&p.useNativeClamp)d.overflow="hidden",d.textOverflow="ellipsis",d.webkitBoxOrient="vertical",d.display="-webkit-box",d.webkitLineClamp=C,m&&(d.height=p.clamp+"px");else{var x=l(C);x<e.clientHeight&&(y=o(r(e),x))}return{original:h,clamped:y}}return e});